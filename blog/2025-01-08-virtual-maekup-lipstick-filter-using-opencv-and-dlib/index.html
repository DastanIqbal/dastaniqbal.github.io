<!doctype html><html lang=en><head><meta charset=utf-8><title>Virtual Makeup: Lipstick Effect using OpenCV and Dlib - Iqbal Ahmed</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.72.0"><meta itemprop=name content="Virtual Makeup: Lipstick Effect using OpenCV and Dlib"><meta itemprop=description content="In this post we will learn how to apply lipstick color using OpenCV and Dlib."><meta itemprop=datePublished content="2025-01-08T06:07:19+00:00"><meta itemprop=dateModified content="2025-01-08T06:07:19+00:00"><meta itemprop=wordCount content="664"><meta itemprop=keywords content="opencv,dlib,numpy,matplotlib,python,"><meta property="og:title" content="Virtual Makeup: Lipstick Effect using OpenCV and Dlib"><meta property="og:description" content="In this post we will learn how to apply lipstick color using OpenCV and Dlib."><meta property="og:type" content="article"><meta property="og:url" content="https://dastaniqbal.github.io/blog/2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib/"><meta property="article:published_time" content="2025-01-08T06:07:19+00:00"><meta property="article:modified_time" content="2025-01-08T06:07:19+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Virtual Makeup: Lipstick Effect using OpenCV and Dlib"><meta name=twitter:description content="In this post we will learn how to apply lipstick color using OpenCV and Dlib."><link rel=stylesheet href=/css/bundle.min.d66f3b75b5ee1f66bff020d4fd5d2f410d6348d7982f196dcf0075eef162aebe.css integrity="sha256-1m87dbXuH2a/8CDU/V0vQQ1jSNeYLxltzwB17vFirr4="><link rel=stylesheet href=/css/add-on.css></head><body><header id=site-header><nav id=site-nav><h1 class=nav-title><a href=/ class=nav>Blog</a></h1><menu id=site-nav-menu class="flyout-menu menu"><a href=/ class="nav link"><i class="fa fa-home"></i>Home</a>
<a href=/about/ class="nav link"><i class="far fa-id-card"></i>About</a>
<a href=/blog/ class="nav link"><i class="far fa-newspaper"></i>Blog</a>
<a href=/categories/ class="nav link"><i class="fas fa-sitemap"></i>Categories</a>
<a href=/contact/ class="nav link"><i class="far fa-envelope"></i>Contact</a>
<a href=#share-menu class="nav share-toggle"><i class="fas fa-share-alt">&nbsp;</i>Share</a>
<a href=#search-input class="nav search-toggle"><i class="fas fa-search">&nbsp;</i>Search</a></menu>
<a href=#search-input class="nav search-toggle"><i class="fas fa-search fa-2x">&nbsp;</i></a>
<a href=#share-menu class="nav share-toggle"><i class="fas fa-share-alt fa-2x">&nbsp;</i></a>
<a href=#site-nav class="nav nav-toggle"><i class="fas fa-bars fa-2x"></i></a></nav><menu id=search class=menu><input id=search-input class="search-input menu"></input><div id=search-results class="search-results menu"></div></menu><menu id=share-menu class="flyout-menu menu"><h1>Share Post</h1><a href="//twitter.com/share?text=Virtual%20Makeup%3a%20Lipstick%20Effect%20using%20OpenCV%20and%20Dlib&url=https%3a%2f%2fdastaniqbal.github.io%2fblog%2f2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib%2f" target=_blank rel=noopener class="nav share-btn twitter"><i class="fab fa-twitter"></i><p>&nbsp;Twitter</p></a><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fdastaniqbal.github.io%2fblog%2f2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib%2f" target=_blank rel=noopener class="nav share-btn facebook"><i class="fab fa-facebook"></i><p>&nbsp;Facebook</p></a><a href="//www.reddit.com/submit?url=https%3a%2f%2fdastaniqbal.github.io%2fblog%2f2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib%2f&title=Virtual%20Makeup%3a%20Lipstick%20Effect%20using%20OpenCV%20and%20Dlib" target=_blank rel=noopener class="nav share-btn reddit"><i class="fab fa-reddit-alien"></i><p>&nbsp;Reddit</p></a><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fdastaniqbal.github.io%2fblog%2f2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib%2f&title=Virtual%20Makeup%3a%20Lipstick%20Effect%20using%20OpenCV%20and%20Dlib" target=_blank rel=noopener class="nav share-btn linkedin"><i class="fab fa-linkedin"></i><p>&nbsp;LinkedIn</p></a><a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fdastaniqbal.github.io%2fblog%2f2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib%2f&description=Virtual%20Makeup%3a%20Lipstick%20Effect%20using%20OpenCV%20and%20Dlib" target=_blank rel=noopener class="nav share-btn pinterest"><i class="fab fa-pinterest-p"></i><p>&nbsp;Pinterest</p></a><a href="mailto:?subject=Check%20out%20this%20post%20by %7b%20%20%20%20%20%20%20%20map%5b%5d%7d&body=https%3a%2f%2fdastaniqbal.github.io%2fblog%2f2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib%2f" target=_blank class="nav share-btn email" data-proofer-ignore><i class="fas fa-envelope"></i><p>&nbsp;Email</p></a></menu></header><div id=wrapper><section id=site-intro><a href=/><img src=https://dastaniqbal.github.io/img/profile.jpg class=circle width=200 alt="Profile Pic"></a><header><h1>Iqbal Ahmed</h1></header><main><p>I develop <b>Android</b> Apps along with Backend<br>and My only LOVE is <b>Kotlin</b></p></main><footer><ul class=socnet-icons><li><a href=//github.com/DastanIqbal target=_blank rel=noopener title=GitHub class="fab fa-github"></a></li><li><a href=//linkedin.com/in/iqbalahmedandroid target=_blank rel=noopener title=LinkedIn class="fab fa-linkedin"></a></li><li><a href=mailto:ask2iqbal@gmail.com target=_blank title=Email class="far fa-envelope"></a></li></ul></footer></section><main id=site-main><article class=post><header><div class=title><h2><a href=/blog/2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib/>Virtual Makeup: Lipstick Effect using OpenCV and Dlib</a></h2><p>In this post we will learn how to apply lipstick color using OpenCV and Dlib.</p></div><div class=meta><time class=published datetime="2025-01-08 06:07:19.276 +0000 UTC">January 8, 2025</time>
<span class=author></span><p>4 minute read</p></div></header><section id=socnet-share><a href="//twitter.com/share?text=Virtual%20Makeup%3a%20Lipstick%20Effect%20using%20OpenCV%20and%20Dlib&url=https%3a%2f%2fdastaniqbal.github.io%2fblog%2f2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib%2f" target=_blank rel=noopener class="nav share-btn twitter"><i class="fab fa-twitter"></i><p>&nbsp;Twitter</p></a><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fdastaniqbal.github.io%2fblog%2f2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib%2f" target=_blank rel=noopener class="nav share-btn facebook"><i class="fab fa-facebook"></i><p>&nbsp;Facebook</p></a><a href="//www.reddit.com/submit?url=https%3a%2f%2fdastaniqbal.github.io%2fblog%2f2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib%2f&title=Virtual%20Makeup%3a%20Lipstick%20Effect%20using%20OpenCV%20and%20Dlib" target=_blank rel=noopener class="nav share-btn reddit"><i class="fab fa-reddit-alien"></i><p>&nbsp;Reddit</p></a><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fdastaniqbal.github.io%2fblog%2f2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib%2f&title=Virtual%20Makeup%3a%20Lipstick%20Effect%20using%20OpenCV%20and%20Dlib" target=_blank rel=noopener class="nav share-btn linkedin"><i class="fab fa-linkedin"></i><p>&nbsp;LinkedIn</p></a><a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fdastaniqbal.github.io%2fblog%2f2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib%2f&description=Virtual%20Makeup%3a%20Lipstick%20Effect%20using%20OpenCV%20and%20Dlib" target=_blank rel=noopener class="nav share-btn pinterest"><i class="fab fa-pinterest-p"></i><p>&nbsp;Pinterest</p></a><a href="mailto:?subject=Check%20out%20this%20post%20by %7b%20%20%20%20%20%20%20%20map%5b%5d%7d&body=https%3a%2f%2fdastaniqbal.github.io%2fblog%2f2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib%2f" target=_blank class="nav share-btn email" data-proofer-ignore><i class="fas fa-envelope"></i><p>&nbsp;Email</p></a></section><div class=content><p>In this post we will walk through the solution to apply lipstick on lips.</p><p>We are using dlib to detect the face and extract facial landmark. We will use OpenCV capabilities to do image processing.</p><p>These are the steps needed</p><ol><li>Image with face</li><li>Detect face on the image</li><li>Find lips landmark using dlib.</li><li>Create a mask for the lips</li><li>Apply alpha blending mask and original image
For eg: I = aF + (1-a)B</li><li>Display image with applied lipstick</li></ol><p><strong>Step 1. Image with faces</strong></p><p><img src=/img/uploads/girl-no-makeup.jpg alt=css_300></p><p>We will use this image to apply lipstick color on lips</p><p><strong>Step 2. Detect face on the image</strong></p><p>T﻿o detect faces we use <code>dlib</code> library</p><p><code>dlib</code> provide this method <code>dlib.get_frontal_face_detector()</code> to detect the face and to detect landmarks we will use <code>dlib.shape_predictor("shape_predictor_68_face_landmarks.dat")</code></p><p>T﻿o get the landmarks point, we can use this method to extract landmarks from face.</p><pre><code class=language-ipynb data-lang=ipynb>def getLandmarks(faceDetector, landmarkDetector, im, FACE_DOWNSAMPLE_RATIO = 1):
  points = []
  imSmall = cv2.resize(im,None,
                       fx=1.0/FACE_DOWNSAMPLE_RATIO,
                       fy=1.0/FACE_DOWNSAMPLE_RATIO,
                       interpolation = cv2.INTER_LINEAR)

  faceRects = faceDetector(imSmall, 0)

  if len(faceRects) &gt; 0:
    maxArea = 0
    maxRect = None
    # TODO: test on images with multiple faces
    for face in faceRects:
      if face.area() &gt; maxArea:
        maxArea = face.area()
        maxRect = [face.left(),
                   face.top(),
                   face.right(),
                   face.bottom()
                  ]

    rect = dlib.rectangle(*maxRect)
    scaledRect = dlib.rectangle(int(rect.left()*FACE_DOWNSAMPLE_RATIO),
                             int(rect.top()*FACE_DOWNSAMPLE_RATIO),
                             int(rect.right()*FACE_DOWNSAMPLE_RATIO),
                             int(rect.bottom()*FACE_DOWNSAMPLE_RATIO))

    landmarks = landmarkDetector(im, scaledRect)
    points = dlibLandmarksToPoints(landmarks)
  return points
</code></pre><p>As we can see in this method first we are resizing the image and using <code>faceDetector</code> to find faces on image.</p><p>Once we found faces, we search landmarks using <code>landmarkDetector</code>. and then converting landmarks to points.</p><p><strong>Step 3: Find lips landmark using dlib.</strong></p><p>Indices 48 to 67 in points represent outer and inner contours of the lips.</p><pre><code class=language-ipynb data-lang=ipynb>lipsContours = points[48:68]
</code></pre><p><strong>Step 4: Create a mask for the lips</strong></p><p>To create mask we need to create blank matrix with zeros. Then we need to fill the lips region with the lipstick color, to fill the color on lips region we will use <code>cv2.fillPoly().</code></p><pre><code class=language-ipynb data-lang=ipynb>lipstick_color = (225, 0, 50)  
mask = np.zeros(imDlib.shape, dtype=imDlib.dtype)
featurePoints = np.array(lipsContours, dtype=np.int32)
cv2.fillPoly(mask, [featurePoints], lipstick_color)
</code></pre><p><img src=/img/uploads/mask_lips.png alt=css_300></p><p><strong>Step 5: Apply alpha blend</strong></p><p>Once we prepared mask then we just need to apply alpha blending by using this equation</p><p>I = α⋅F+(1−α)⋅B</p><p>α is the alpha</p><p>F is the foreground</p><p>B is the background</p><p>Create alpha mask using <code>mask</code></p><pre><code class=language-ipynb data-lang=ipynb>alphaMask = cv2.cvtColor(mask, cv2.COLOR_RGB2GRAY)
alphaMask = cv2.merge((alphaMask, alphaMask, alphaMask))
</code></pre><p><img src=/img/uploads/alphamask_lips.png alt=css_300></p><p>α is the <code>alphaMask</code></p><p>foreground we will use as <code>mask</code>,</p><p>background we will use as original image <code>imDlib</code></p><pre><code class=language-ipynb data-lang=ipynb>alpha = np.float32(alphaMask) / 255.0
fore = np.float32(mask) / 255.0
back = np.float32(imDlib) / 255.0
</code></pre><p>we normalize all the matrix values range 0 to 1 and the apply the equation</p><pre><code class=language-ipynb data-lang=ipynb>outImage = alpha * fore + (1 - alpha) *  back
</code></pre><p>T﻿o be consider here when alpha is 0 means it&rsquo;s transparent and if it&rsquo;s 1 then it&rsquo;s full visible</p><p><code>alpha * fore</code></p><p>Multiplication of alpha and foreground will give the applied lipstick color along with alpha visibility on lips region</p><p><img src=/img/uploads/alphamore_lips.png alt=css_300></p><p>and this part will give the whole image but without lips region, as we can see we are subtracting alpha with 1, it&rsquo;s mean we are reversing the <code>alphaMask</code></p><p><code>(1 - alpha) * back</code></p><p><img src=/img/uploads/alphaback_lips.png alt=css_300></p><p>so once we add both part we will get the correct result which we want to achieve.</p><p><strong>Step 6: Displaying Image</strong></p><p>Here we can see <code>imDlib</code> is the original image and applied lipstick <code>outImage</code></p><pre><code class=language-ipynb data-lang=ipynb>plt.imshow(outImage)
</code></pre><p><img src=/img/uploads/outimage_lips.png alt=css_300></p><p>as we have seen with simple image processing we can get this Lipstick Effect on any face.</p><p><strong>T﻿his is the complete code</strong></p><pre><code class=language-ipynb data-lang=ipynb># Apply Lipstick

# Get the landmarks of the lips
featurePoints = points[48:68]

# Create a mask for the lips
lipstick_color = (225,0,50)
mask = np.zeros(imDlib.shape,dtype=imDlib.dtype)
featurePoints = np.array(featurePoints, dtype = np.int32)
cv2.fillPoly(mask,[featurePoints],lipstick_color)

alphaMask = cv2.cvtColor(mask, cv2.COLOR_RGB2GRAY)
alphaMask = cv2.merge((alphaMask, alphaMask, alphaMask))

alpha = np.float32(alphaMask) /255.0
fore = np.float32(mask) / 255.0
back = np.float32(imDlib) / 255.0

alphaFore = alpha*fore
alphaBack = (1 - alpha)*back

# Apply alpha blending I = a*F + (1-a)*B
outImage = alpha*fore + (1 - alpha)*back

plt.figure(figsize=(20,20))
plt.subplot(121)
plt.imshow(imDlib)
plt.title(&quot;Original&quot;)

plt.subplot(122)
plt.imshow(outImage)
plt.title(&quot;Applied Lipstick&quot;)
</code></pre><p><strong>R﻿eferences:</strong></p><ul><li><a href=https://opencv.org/university/computer-vision-and-deep-learning-applications/>https://opencv.org/university/computer-vision-and-deep-learning-applications/</a></li></ul></div><footer><ul class=stats><li class=categories><ul><li><a class=article-terms-link href=/categories/opencv/>OpenCV</a></li><li><a class=article-terms-link href=/categories/python/>Python</a></li><li><a class=article-terms-link href=/categories/dlib/>dlib</a></li><li><a class=article-terms-link href=/categories/image-processing/>Image Processing</a></li></ul></li><li class=tags><ul><li><a class=article-terms-link href=/tags/opencv/>opencv</a></li><li><a class=article-terms-link href=/tags/dlib/>dlib</a></li><li><a class=article-terms-link href=/tags/numpy/>numpy</a></li><li><a class=article-terms-link href=/tags/matplotlib/>matplotlib</a></li><li><a class=article-terms-link href=/tags/python/>python</a></li></ul></li></ul></footer></article><article class=post><div><h2>Say something</h2><form id=post-js-form class=post-new-comment method=post><h5 class="post-reply-notice hidden"><span class=post-reply-arrow></span><span class=post-reply-name></span></h5><input type=hidden name=options[entryId] value=6ac5e90824e9163e175cbf6caddf5754>
<input type=hidden name=fields[replyThread]>
<input type=hidden name=fields[replyID]>
<input type=hidden name=fields[replyName]>
<input required name=fields[name] type=text placeholder="Your name (Required)">
<input name=fields[website] type=hidden placeholder="Your website">
<input name=fields[email] type=hidden placeholder="Your email address (Required)">
<textarea required name=fields[body] placeholder="Your message. Feel free to use Markdown (Google 'Markdown Cheat Sheet')." rows=10></textarea>
<input hidden name=options[reCaptcha][siteKey] value=6LevL8MZAAAAANSK97K7fsuvwaTqjtqUi1c71JbC>
<input hidden name=options[reCaptcha][secret] value="NL+P1esF14LTofak+e68fuOjbGDMP9WDjbhUrRWhTGPEyKHGd8BIJEkpX9fGJmAmZdgIltbDJc0od2NU8dK43nZpZFVSS0Nc05kSmymrLuC2DApaPMgpZ26mYBcCaU9aRDZ2O58EhMQhhqxORI8QM5LF5dwIcC/ZU0epIHIuInSjo30a0PtnFGy7kRARDqzKhtD3v+sdhMaCZfMFhIxJUTgz6mkVXQkmT/qduv8QArIyyqOX4r8QEkQDOn8NZbnFujBMpWWmHsJJzbQ+Yd2T47NYUWlJRi234F3A+W4aYND8w/8ojnp0k2g7u7f71khDd1JI7sNO/ia88mfmIQlM0A=="><div class=g-recaptcha data-sitekey=6LevL8MZAAAAANSK97K7fsuvwaTqjtqUi1c71JbC></div><p class=post-submit-notice><strong class="post-submit-notice-text submit-success hidden">Thanks for your comment! It will be shown on the site once it has been approved.</strong>
<strong class="post-submit-notice-text submit-failed hidden">Sorry, there was an error with your submission. Please make sure all required fields have been completed and try again.</strong></p><input type=submit value=Submit class=button>
<input type=submit value=Submitted class="hidden button" disabled>
<input type=reset value=Reset class=button></form></div><div><h2>Comments</h2><p>Nothing yet.</p></div></article><div class=pagination><a href=/blog/2021-05-20-opencv-series-4-numpy-data-structures/ class=button><div class=previous><div>OpenCV Series: 3. Numpy Data Structures</div></div></a><a href=/blog/2025-01-08-virtual-makeup-eyeliner-effect-using-opencv-and-dlib/ class=button><div class=next><div>Virtual Makeup: Eyeliner Effect using OpenCV and Dlib</div></div></a></div></main><section id=site-sidebar><section id=recent-posts><header><h1>Recent posts</h1></header><article class=mini-post><section></section><header><h2><a href=/blog/2025-01-08-virtual-makeup-eyeliner-effect-using-opencv-and-dlib/>Virtual Makeup: Eyeliner Effect using OpenCV and Dlib</a></h2><time class=published datetime>January 8, 2025</time></header></article><article class=mini-post><section></section><header><h2><a href=/blog/2025-01-08-virtual-maekup-lipstick-filter-using-opencv-and-dlib/>Virtual Makeup: Lipstick Effect using OpenCV and Dlib</a></h2><time class=published datetime>January 8, 2025</time></header></article><article class=mini-post><section></section><header><h2><a href=/blog/2021-05-20-opencv-series-4-numpy-data-structures/>OpenCV Series: 3. Numpy Data Structures</a></h2><time class=published datetime>May 20, 2021</time></header></article><article class=mini-post><section></section><header><h2><a href=/blog/2021-05-17-opencv-series-2-get-started-with-opencv-and-python/>OpenCV Series: 2. Get Started with OpenCV and Python</a></h2><time class=published datetime>May 17, 2021</time></header></article><article class=mini-post><section></section><header><h2><a href=/blog/2021-05-15-opencv-series-installing-python-and-opencv-on-mac/>OpenCV Series: 1. Installing Python and OpenCV on Mac</a></h2><time class=published datetime>May 15, 2021</time></header></article><footer><a href=/blog/ class=button>See more</a></footer></section><section id=categories><header><h1><a href=/categories>Categories</a></h1></header><ul><li><a href=/categories/android/>android<span class=count>6</span></a><li><a href=/categories/python/>python<span class=count>6</span></a><li><a href=/categories/opencv/>opencv<span class=count>5</span></a><li><a href=/categories/epoxy/>epoxy<span class=count>4</span></a><li><a href=/categories/dlib/>dlib<span class=count>2</span></a><li><a href=/categories/image-processing/>image-processing<span class=count>2</span></a><li><a href=/categories/automation/>automation<span class=count>1</span></a><li><a href=/categories/kotlin-ktlint/>kotlin-ktlint<span class=count>1</span></a><li><a href=/categories/script/>script<span class=count>1</span></a></li></ul></section><section id=mini-bio><header><h1>About</h1></header><p>I develop <b>Android</b> Apps along with Backend<br>and My only LOVE is <b>Kotlin</b></p><footer><a href=/about class=button>Learn More</a></footer></section></section><footer id=site-footer><ul class=socnet-icons><li><a href=//github.com/DastanIqbal target=_blank rel=noopener title=GitHub class="fab fa-github"></a></li><li><a href=//linkedin.com/in/iqbalahmedandroid target=_blank rel=noopener title=LinkedIn class="fab fa-linkedin"></a></li><li><a href=mailto:ask2iqbal@gmail.com target=_blank title=Email class="far fa-envelope"></a></li></ul><p class=copyright>&copy; 2025
Iqbal Ahmed
.<br>Theme: <a href=https://github.com/pacollins/hugo-future-imperfect-slim target=_blank rel=noopener>Hugo Future Imperfect Slim</a><br>A <a href=https://html5up.net/future-imperfect target=_blank rel=noopener>HTML5 UP port</a> | Powered by <a href=https://gohugo.io/ title=0.72.0 target=_blank rel=noopener>Hugo</a></p></footer><a id=back-to-top href=# class="fas fa-arrow-up fa-2x"></a><script src=/js/highlight.js></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/bundle.min.6f5c4053cb6543b40cde4b88cf14eac1cf031dd6e51fbf58eb4a7c48df9464ce.js integrity="sha256-b1xAU8tlQ7QM3kuIzxTqwc8DHdblH79Y60p8SN+UZM4="></script><script src=/js/add-on.js></script><script src=https://www.google.com/recaptcha/api.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-84856101-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></div></body></html>